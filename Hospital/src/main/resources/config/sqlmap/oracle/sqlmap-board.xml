<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.byby.dao.HospitalBoardDAO">

	<!-- 특정번호 게시글 수정 -->
	<update id ="update"  parameterType="HospitalBoardVO">
		update Board_tb
			set
				title = #{title},
				content = #{content}
				where no = #{no}
	</update>
	
	<!-- 특정번호 게시글 삭제 -->
	<delete id="deleteByNo" parameterType="int">
		delete from Board_tb
		where no = #{no}
	</delete>

	<!-- 특정번호 병원게시글 조회 -->
	<!-- 게시글 번호로 뽑아내서 파라미터타입이 인트임. -->
	<select id="selectByNo" parameterType="int" resultType="HospitalBoardVO">
		select no, title, ctg_no, content, viewcnt, to_char(wrt_date, 'yyyy-mm-dd') as wrt_date, memberid
		from Board_tb		
		where no = #{no}
	</select>
	
	<!-- 전체게시글조회(페이징) -->
	<select id="listPage" parameterType="kr.co.byby.dto.HospitalCriteria" resultType="HospitalBoardVO">
		select no, title, ctg_no, viewcnt, wrt_date, memberid
    	from ( select no,title, ctg_no, viewcnt, wrt_date, memberid,
    	row_number() over(order by no desc)as rNum
    	from board_tb) mb 
    	where rNum between #{rowStart} and #{rowEnd}
    	order by no desc
	</select>
	
	<select id="listCount" resultType="int">
	<![CDATA[
		select count(no)
		from board_tb
		where no > 0
	]]>
	</select>


	<!-- 전체게시글 조회 -->
	<select id="selectAll" resultType="HospitalBoardVO">
		select no, title, ctg_no, content, viewcnt, to_char(wrt_date, 'yyyy-mm-dd') as wrt_date, memberid
		from Board_tb
		order by no desc
	</select>


	<!-- 게시글 삽입 -->
	<insert id="insert" parameterType="HospitalBoardVO">
		insert into Board_tb(no, title, ctg_no, content, memberid)
		values(board_no.nextval, #{title}, #{ctg_no},#{content},#{memberid})
	</insert>


</mapper>